<?php
namespace GuzzleHttp\Subscriber; use GuzzleHttp\Cookie\CookieJar; use GuzzleHttp\Cookie\CookieJarInterface; use GuzzleHttp\Event\BeforeEvent; use GuzzleHttp\Event\CompleteEvent; use GuzzleHttp\Event\RequestEvents; use GuzzleHttp\Event\SubscriberInterface; class Cookie implements SubscriberInterface { private $cookieJar; public function __construct(CookieJarInterface $cookieJar = null) { $this->cookieJar = $cookieJar ?: new CookieJar(); } public function getEvents() { return [ 'before' => ['onBefore'], 'complete' => ['onComplete', RequestEvents::REDIRECT_RESPONSE + 10] ]; } public function getCookieJar() { return $this->cookieJar; } public function onBefore(BeforeEvent $event) { $this->cookieJar->addCookieHeader($event->getRequest()); } public function onComplete(CompleteEvent $event) { $this->cookieJar->extractCookies( $event->getRequest(), $event->getResponse() ); } } 